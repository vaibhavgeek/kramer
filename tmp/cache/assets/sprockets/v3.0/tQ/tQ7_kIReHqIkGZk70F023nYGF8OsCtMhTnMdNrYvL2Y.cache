I"”(function() {
  var FacebookReply;

  FacebookReply = (function() {
    function FacebookReply() {}

    FacebookReply.action = function(actions, ticket, article, ui) {
      if (ui.permissionCheck('ticket.customer')) {
        return actions;
      }
      if (article.type.name === 'facebook feed post' || article.type.name === 'facebook feed comment') {
        actions.push({
          name: 'reply',
          type: 'facebookFeedReply',
          icon: 'reply',
          href: '#'
        });
      }
      return actions;
    };

    FacebookReply.perform = function(articleContainer, type, ticket, article, ui) {
      var articleNew;
      if (type !== 'facebookFeedReply') {
        return true;
      }
      ui.scrollToCompose();
      type = App.TicketArticleType.findByAttribute('name', 'facebook feed comment');
      articleNew = {
        to: '',
        cc: '',
        body: '',
        in_reply_to: ''
      };
      App.Event.trigger('ui::ticket::setArticleType', {
        ticket: ticket,
        type: type,
        article: articleNew
      });
      return true;
    };

    FacebookReply.articleTypes = function(articleTypes, ticket, ui) {
      var articleTypeCreate;
      if (!ui.permissionCheck('ticket.agent')) {
        return articleTypes;
      }
      if (!ticket || !ticket.create_article_type_id) {
        return articleTypes;
      }
      articleTypeCreate = App.TicketArticleType.find(ticket.create_article_type_id).name;
      if (articleTypeCreate === 'facebook feed post') {
        articleTypes.push({
          name: 'facebook feed comment',
          icon: 'facebook',
          attributes: [],
          internal: false,
          features: []
        });
      }
      return articleTypes;
    };

    FacebookReply.params = function(type, params, ui) {
      if (type === 'facebook feed comment') {
        App.Utils.htmlRemoveRichtext(ui.$('[data-name=body]'), false);
        params.content_type = 'text/plain';
        params.body = App.Utils.html2text(params.body, true);
      }
      return params;
    };

    return FacebookReply;

  })();

  App.Config.set('300-FacebookReply', FacebookReply, 'TicketZoomArticleAction');

}).call(this);
:ET