I"Ã(function() {
  var TicketCreateFormHanderSignature;

  TicketCreateFormHanderSignature = (function() {
    function TicketCreateFormHanderSignature() {}

    TicketCreateFormHanderSignature.run = function(params, attribute, attributes, classname, form, ui) {
      var currentBody, group, signature, signatureFinished, signature_id, type;
      if (!attribute) {
        return;
      }
      if (attribute.name !== 'group_id') {
        return;
      }
      signature = void 0;
      if (params['group_id']) {
        group = App.Group.find(params['group_id']);
        if (group && group.signature_id) {
          signature = App.Signature.find(group.signature_id);
        }
      }
      type = ui.el.closest('.content').find('[name="formSenderType"]').val();
      if (signature && signature.body && type === 'email-out') {
        signatureFinished = App.Utils.replaceTags(signature.body, {
          user: App.Session.get(),
          config: App.Config.all()
        });
        currentBody = ui.el.closest('.content').find('[data-name=body]');
        if (!_.isEmpty(currentBody)) {
          if (App.Utils.signatureCheck(currentBody.html() || '', signatureFinished)) {
            signature_id = ui.el.closest('.content').find('[data-signature=true]').data('signature-id');
            if (signature_id && signature_id.toString() !== signature.id.toString()) {
              ui.el.closest('.content').find('[data-signature="true"]').remove();
            }
            if (!App.Utils.htmlLastLineEmpty(currentBody)) {
              currentBody.append('<br><br>');
            }
            signature = $("<div data-signature=\"true\" data-signature-id=\"" + signature.id + "\">" + signatureFinished + "</div>");
            App.Utils.htmlStrip(signature);
            currentBody.append(signature);
            return ui.el.closest('.content').find('[data-name=body]').replaceWith(currentBody);
          }
        }
      } else {
        return ui.el.closest('.content').find('[data-name="body"]').find('[data-signature=true]').remove();
      }
    };

    return TicketCreateFormHanderSignature;

  })();

  App.Config.set('200-ticketFormSignature', TicketCreateFormHanderSignature, 'TicketCreateFormHandler');

}).call(this);
:ET